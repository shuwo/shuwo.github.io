<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>我决定在我的网站上禁用AMP[译文] | 数沃前端组Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="原文：https://www.alexkras.com/i-decided-to-disable-amp-on-my-site（有删减）  我和Google的Accelerated Mobile Pages (AMP) 项目有一段很长的渊源，但昨天我忍无可忍了。 我在Twitter（iPhone 6的Safari）上注意到有人用一个AMP链接到我的网站。我回复了一个真实链接，但当我点击这个链接的时">
<meta property="og:type" content="article">
<meta property="og:title" content="我决定在我的网站上禁用AMP[译文]">
<meta property="og:url" content="http://yoursite.com/2017/06/30/1-disable-amp/index.html">
<meta property="og:site_name" content="数沃前端组Blog">
<meta property="og:description" content="原文：https://www.alexkras.com/i-decided-to-disable-amp-on-my-site（有删减）  我和Google的Accelerated Mobile Pages (AMP) 项目有一段很长的渊源，但昨天我忍无可忍了。 我在Twitter（iPhone 6的Safari）上注意到有人用一个AMP链接到我的网站。我回复了一个真实链接，但当我点击这个链接的时">
<meta property="og:image" content="https://www.alexkras.com/wp-content/uploads/amp-link.png">
<meta property="og:image" content="https://www.alexkras.com/wp-content/uploads/France-Election.png">
<meta property="og:updated_time" content="2017-07-26T11:12:31.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我决定在我的网站上禁用AMP[译文]">
<meta name="twitter:description" content="原文：https://www.alexkras.com/i-decided-to-disable-amp-on-my-site（有删减）  我和Google的Accelerated Mobile Pages (AMP) 项目有一段很长的渊源，但昨天我忍无可忍了。 我在Twitter（iPhone 6的Safari）上注意到有人用一个AMP链接到我的网站。我回复了一个真实链接，但当我点击这个链接的时">
<meta name="twitter:image" content="https://www.alexkras.com/wp-content/uploads/amp-link.png">
  
    <link rel="alternate" href="/atom.xml" title="数沃前端组Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">数沃前端组Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-1-disable-amp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/30/1-disable-amp/" class="article-date">
  <time datetime="2017-06-29T16:00:00.000Z" itemprop="datePublished">2017-06-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      我决定在我的网站上禁用AMP[译文]
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文：<a href="https://www.alexkras.com/i-decided-to-disable-amp-on-my-site" target="_blank" rel="external">https://www.alexkras.com/i-decided-to-disable-amp-on-my-site</a><br>（有删减）</p>
<p><img src="https://www.alexkras.com/wp-content/uploads/amp-link.png" alt="图片"></p>
<p>我和Google的Accelerated Mobile Pages (AMP) 项目有一段很长的渊源，但昨天我忍无可忍了。</p>
<p>我在Twitter（iPhone 6的Safari）上注意到有人用一个AMP链接到我的网站。我回复了一个真实链接，但当我点击这个链接的时候，又被重定向到了AMP的版本。</p>
<a id="more"></a>
<p>我复制了Twitter生成的这个链接，它看起来是这样子的：<code>https://t.co/6drRK5Cugz?amp=1</code></p>
<p>注意链接中的<code>amp=1</code>。当我点击链接，它返回了下面的HTML页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> </span></div><div class="line">            <span class="attr">content</span>=<span class="string">"0;URL=https://www.alexkras.com/simple-guide-to-finding-a-javascript-memory-leak-in-node-js/amp/"</span> </div><div class="line">        /&gt;</div><div class="line">    <span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>https://www.alexkras.com/simple-guide-to-finding-a-javascript-memory-leak-in-node-js/amp/<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">window.opener = null;</div><div class="line">location</div><div class="line">    .replace(`https:\/\/www.alexkras.com\/</div><div class="line">        simple-guide-to-finding-a-javascript-memory-leak-in-node-js\</div><div class="line">        /amp\/`)</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这个页面的唯一目的就是重定向到链接的AMP版本。</p>
<h2 id="作为一个发布者AMP对我造成的问题"><a href="#作为一个发布者AMP对我造成的问题" class="headerlink" title="作为一个发布者AMP对我造成的问题"></a>作为一个发布者AMP对我造成的问题</h2><p>当AMP刚问世的时候，我是很看好的。AMP的目的是为了让访问网络更快，这个我很赞赏。</p>
<p>作为一个发布者，我很不喜欢的是事实上Google在缓存AMP内容，并且从他们自己的缓存和自己的域名下面提供这些内容。最终的链接会变成这样：</p>
<p><code>https://www.google.com/amp/www.bbc.co.uk/news/amp/39130072</code></p>
<p><img src="https://www.alexkras.com/wp-content/uploads/France-Election.png" alt=""></p>
<p>换句话说，内容不是从BBC.co.uk上获取的，而是从google.com上获取的。</p>
<p>这个结果造成了几个问题：</p>
<ol>
<li>它“欺骗”了Google的用户。如果用户点击了上面截图的“x”他们会被带回Google搜索结果。而一个普通的跳转会让用户更可能的留在BBC的网站。相反，AMP的返回按钮提供的这个功能让用户更可能回到Google。这对用户是无关紧要的，但对于作者却是个糟糕的结果。</li>
<li>这个系统会被滥用。例如从AMP上获取的假新闻可能会被一个比较单纯的用户信任，因为新闻是从google.com上获取的——一个很权威的域名。</li>
</ol>
<h4 id="讽刺的是，这并不是Twitter在做的。"><a href="#讽刺的是，这并不是Twitter在做的。" class="headerlink" title="讽刺的是，这并不是Twitter在做的。"></a>讽刺的是，这并不是Twitter在做的。</h4><p>我想Twitter的做法基于了一个前提：通过AMP格式提供的内容对于用户来说更好。因此，他们仅仅是为了取悦用户并且提供最可能好的内容格式。</p>
<p>我不能责怪Twitter把我的推送内容变成AMP版本，要怪就怪我自己，因为是否使用AMP是完全可选的，但是我选择了再我的网站上激活。</p>
<h2 id="作为一个用户AMP对我造成的问题"><a href="#作为一个用户AMP对我造成的问题" class="headerlink" title="作为一个用户AMP对我造成的问题"></a>作为一个用户AMP对我造成的问题</h2><p>AMP由三个组件组成：HTML，Javascript库和缓存。我想说一下上一节提到的缓存问题。缓存的好处，google的AMP工程师跟我们解释了，就是它允许Google（或者其他平台）为用户预加载内容。当用户点击一个AMP链接，Google几乎可以立刻渲染结果，因为它已经在后台获取了。</p>
<p>但又一次讽刺的是，Twitter并没有用缓存这一层。Twitter在打赌，移动用户在AMP可用的情况下宁愿阅读AMP渲染的内容，即使它没有予加载到后台。</p>
<p>而我的问题是我根本就不喜欢阅读AMP内容。AMP对我来说有很多小问题真的恶心到我了。</p>
<p>例如：</p>
<h4 id="坑爹的滚动"><a href="#坑爹的滚动" class="headerlink" title="坑爹的滚动"></a>坑爹的滚动</h4><p>在iPhone上，AMP似乎覆盖了浏览器的默认滚动，结果是AMP页面的滚动体验不好。</p>
<h4 id="很难分享链接"><a href="#很难分享链接" class="headerlink" title="很难分享链接"></a>很难分享链接</h4><p>用AMP很难分享链接到原内容。<br>从浏览器顶部的地址栏上不能拷贝到链接，用户必须点击<a href="https://www.alexkras.com/amp-toolbar-now-has-a-button-to-view-and-copy-original-url/" target="_blank" rel="external">一个特殊的按钮</a>才能够看到源地址，然后用户点击源链接，等待调转，才可以从地址栏上复制到链接。</p>
<p>PS：那个源链接按钮其实跟原先的AMP版本比已经是一个很大的进步了，原先用户必须手动删除<code>https://www.google.com/amp/</code>的一部分才能够获取到真实链接。</p>
<p>我不喜欢用AMP内容因为我想确保链接访问的是真正的来源内容。我相信大部分用户不会去复制源链接，他们只会复AMP链接，像<code>https://www.google.com/amp/www.bbc.co.uk/news/amp/39130072</code>，然后分享出去。例如我的老婆，她总是发给我AMP链接。我很惊讶很多发布者惊人没有跟我一样有这些困扰。</p>
<h4 id="AMP内容一般都会被阉割"><a href="#AMP内容一般都会被阉割" class="headerlink" title="AMP内容一般都会被阉割"></a>AMP内容一般都会被阉割</h4><p>回想一下我们以前用的WAP页面——只在移动设备上使用的特定web页面。而发布者选择AMP，某种程度上就像是回到了用WAP页面的时代。发布者不用响应式设计（确保一个网站的版本可以在全部设备上正常展现），而被迫每个页面要维护两个版本，一个常规的版本供大的设备还有不用Google的手机，还有一个AMP版本。</p>
<p>AMP的好处是通过严格显示内容格式让页面加载变快。这个方法的问题是AMP就变成了源内容的子集。例如，用户评论常常就被移除了。</p>
<p>我也发现了<a href="https://github.com/ampproject/amphtml/issues/9397" target="_blank" rel="external">图片在AMP的加载很怪异</a>。AMP试图让图片对用户可见的时候才加载，而没有加载前就是一块方形的空白。但我根据我的经验我经常发现文章中的图片会只是一个方形的空白。</p>
<p>一些不同的网站还有很多其他小问题。例如，Reddit的评论（网站的很重要一部分）被AMP缓存了。结果，新的评论会在Reddit的桌面版本显示，而不会在Reddit的AMP上显示，直到页面的AMP缓存更新了。</p>
<h4 id="AMP对于用户来说不是可选的"><a href="#AMP对于用户来说不是可选的" class="headerlink" title="AMP对于用户来说不是可选的"></a>AMP对于用户来说不是可选的</h4><p>对于发布者来说是否添加AMP支持是取决于他们自己的。但是对于用户，他们没有办法取消AMP。</p>
<p>如果Google可以提供一个用户层面上的设置来取消AMP那就好了。不幸的是，即使他们要加上这个设置，那也不会有太大效果，因为Twitter和Facebook可能只是从AMP上提供内容。</p>
<h2 id="为什么刚开始我在我的网站设置了AMP"><a href="#为什么刚开始我在我的网站设置了AMP" class="headerlink" title="为什么刚开始我在我的网站设置了AMP"></a>为什么刚开始我在我的网站设置了AMP</h2><p>我一开始在我的网站上设置AMP只有一个原因——提高google搜索排名。</p>
<p>AMP成型前不久，google宣布他们将开始处理在移动设备渲染比较慢的网站。我的网站有一个响应式的主题，但我不是很确定这对移动设备是不是够友好。因此，当我知道WordPress有一个AMP插件后，我做了设置。虽然Google官方说明了额AMP并不会影响网站的搜索排名，但我觉得这也不会有什么问题。</p>
<p>另一个AMP的搜索排名优点，就是直邮AMP网站会被显示在Google的carousel中。我倒是对这个无所谓，但是这对于那些大的内容网站来说是很重要的。</p>
<p><a href="https://www.alexkras.com/wp-content/uploads/carousel.png" target="_blank" rel="external"></a></p>
<h2 id="它正在扩散"><a href="#它正在扩散" class="headerlink" title="它正在扩散"></a>它正在扩散</h2><p>当我开始发现Google缓存我的网站，我开始考虑禁用AMP，但我后面决定还是留着，这是我的两个理由：</p>
<ol>
<li>我想保持我的搜索排名</li>
<li>我想把AMP当作一个选择，那些喜欢这个格式的读者可以选择它。</li>
</ol>
<p>知道这次的Twitter体验，我才意识到设置了AMP，允许了其他网站可以选择如何链接到我的内容。</p>
<p>两周前我写了这些：</p>
<blockquote>
<p>我对AMP本身没有问题。我不在意Facebook，Instant，Articles或者Pinterest使用AMP。</p>
</blockquote>
<p>但兄弟我错了。直到我看到我在twitter上的链接被强行用AMP渲染，我想我还是在意的。</p>
<h2 id="用户不需要AMP"><a href="#用户不需要AMP" class="headerlink" title="用户不需要AMP"></a>用户不需要AMP</h2><p>几周前有人在Twitter上说我不喜欢AMP因为我有一个“特权”——我的互联网环境比较快。虽然这是真的，但我不认为在一个网速慢的环境我会用AMP。我会让浏览器金庸javascript（或者图片也仅用掉，如果网速真的很慢）。这或许不能对所有网站起作用，但我的网站是在服务器端渲染和缓存，用户只需要下载一点html就能看到页面。为什么要强制他们去下载AMP这个javascript库呢？</p>
<p>当然，Google推出AMP的原因是他们想让用户看到广告，这些如果禁用掉javascript就看不到了。我也想让用户看到广告，我服务器的花的钱就是通过这个赚到的。话虽如此，如果用户访问我的网站速度很慢然后选择退出让我赚不到这个钱的话我也无所谓。</p>
<p>不管怎样，为了测试我的理论我打开chrome开发者工具然后限制我的网速到最差的有效值并且禁用了javascript。我打开我网站上的一篇文章用了三秒加载完毕。我尝试用Google搜索也很快，但是我没有看到AMP链接。这当然没有，因为AMP链接只有当javascript可用的时候才出现。</p>
<p>我又启用了javascript（网速还是设置很慢）然后搜索一些AMP内容，结果只为了加载新闻carousel，就花了10秒钟。</p>
<p>正如我想的，静态内容还是更胜一筹。</p>
<h2 id="请畅所欲言"><a href="#请畅所欲言" class="headerlink" title="请畅所欲言"></a>请畅所欲言</h2><p>九个月前我第一次写了关于AMP的担心。这引起了Hacker News的一些注意，并且Google的AMP人员积极参与了讨论：<a href="https://news.ycombinator.com/item?id=12722590" target="_blank" rel="external">Hacker News discussion</a>，<a href="https://news.ycombinator.com/item?id=12731311" target="_blank" rel="external">comments of my post</a>。他们甚至邀请我一起吃午餐以便讨论更多我的担心。</p>
<p>两周前我写了一篇相似的文章：<a href="https://www.alexkras.com/please-make-google-amp-optional/" target="_blank" rel="external">Please Make Google AMP Optional</a>。它受到了更多关注，但是没有Google的AMP团队参与。</p>
<p>貌似Google的AMP团队意识到和我们这一部分不喜欢AMP的开发者“交战”不会有什么收益。他们知道我们是少数的一部分不是他们的主要受众。我的妈妈和老婆不会上Hacker News。他们不知AMP是什么并且也不关心web问题。</p>
<p>但另一方面Google有很多工程师关心这个web问题。我很惊讶我没有听到一些反对AMP的声音。我猜这是一个高层支持的项目，并且制造一些异议会有一些风险。</p>
<p>但是，我们这些不喜欢AMP的人必须反抗。</p>
<p>你是不是有一个WordPress网站？关掉AMP或者不要激活它。</p>
<p>你是不是为一个发版商工作然后他用着AMP。那跟你的老板说明AMP的缺点，说明它们有可能造成的风险。</p>
<p>幸亏在WordPress上取消AMP很方便。并且不到24小时google搜索结果就没有显示我网站的AMP版本了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/06/30/1-disable-amp/" data-id="cj5w93olm0000kdwmnbhijuv0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/07/09/2-vue-issue/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Vue踩坑之路
        
      </div>
    </a>
  
  
    <a href="/2017/06/23/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/07/09/2-vue-issue/">Vue踩坑之路</a>
          </li>
        
          <li>
            <a href="/2017/06/30/1-disable-amp/">我决定在我的网站上禁用AMP[译文]</a>
          </li>
        
          <li>
            <a href="/2017/06/23/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>